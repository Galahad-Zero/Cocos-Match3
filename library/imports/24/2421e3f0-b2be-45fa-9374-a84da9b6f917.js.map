{"version":3,"sources":["assets\\Script\\gamePlay\\block\\BlockMgr.ts"],"names":[],"mappings":";;;;;;;;;;;;AACA,6DAAsD;AACtD,2CAAoC;AAEpC,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,EAAE,CAAC,UAAU,CAAC;AAG5C,IAAqB,QAAQ,GAA7B,MAAqB,QAAS,SAAQ,EAAE,CAAC,SAAS;IAAlD;;QAEI,gBAAW,GAAc,IAAI,CAAC;QAK9B,kBAAa,GAAyB,EAAE,CAAC;QAEzC,eAAU,GAAgB,IAAI,CAAC;IAuDnC,CAAC;IArDG;;;;OAIG;IACI,aAAa,CAAC,SAAoB;QACrC,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAC1B,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,SAAS,KAAK,SAAS,CAC3C,CAAC;IACN,CAAC;IAED;;;;OAIG;IACI,QAAQ,CAAC,WAAwB,EAAE,MAAgB;QACtD,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QACxD,IAAI,CAAC,UAAU,EAAE;YACb,OAAO,IAAI,CAAC;SACf;QACD,MAAM,KAAK,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC,GAAG,CAAC,WAAW,EAAE,UAAU,EAAE,MAAM,CAAC,CAAC;QACvE,IAAI,CAAC,KAAK,EAAE;YACR,MAAM,QAAQ,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAClD,MAAM,SAAS,GAAG,QAAQ,CAAC,YAAY,CAAC,mBAAS,CAAC,CAAC;YACnD,SAAS,CAAC,KAAK,CAAC,WAAW,EAAE,UAAU,EAAE,MAAM,CAAC,CAAC;YACjD,OAAO,SAAS,CAAC;SACpB;QACD,OAAO,KAAK,CAAC,YAAY,CAAC,mBAAS,CAAC,CAAC;IACzC,CAAC;IAED;;;OAGG;IACI,QAAQ,CAAC,KAAgB;QAC5B,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IACpC,CAAC;IAEM,YAAY;QACf,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YAClB,IAAI,CAAC,UAAU,GAAG,IAAI,EAAE,CAAC,QAAQ,CAAC,mBAAS,CAAC,CAAC;SAChD;QACD,OAAO,IAAI,CAAC,UAAU,CAAC;IAC3B,CAAC;IAED;;OAEG;IACO,SAAS;QACf,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;QAC3C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;IAC3B,CAAC;CACJ,CAAA;AA9DG;IADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;6CACU;AAK9B;IAHC,QAAQ,CAAC;QACN,IAAI,EAAE,CAAC,4BAAkB,CAAC;KAC7B,CAAC;+CACuC;AAPxB,QAAQ;IAD5B,OAAO;GACa,QAAQ,CAgE5B;kBAhEoB,QAAQ","file":"","sourceRoot":"/","sourcesContent":["import { BlockConfig, BlockType } from '../GameTypes';\nimport BlockStyleProperty from './BlockStyleProperty';\nimport BaseBlock from './BaseBlock';\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class BlockMgr extends cc.Component {\n    @property(cc.Prefab)\n    blockPrefab: cc.Prefab = null;\n\n    @property({\n        type: [BlockStyleProperty],\n    })\n    blockStyleArr: BlockStyleProperty[] = [];\n\n    _blockLoop: cc.NodePool = null;\n\n    /**\n     * 根据方块类型获取方块样式\n     * @param blockType 方块类型\n     * @returns 方块样式\n     */\n    public getBlockStyle(blockType: BlockType): BlockStyleProperty {\n        return this.blockStyleArr.find(\n            (style) => style.blockType === blockType\n        );\n    }\n\n    /**\n     * 根据方块配置获取方块\n     * @param blockConfig 方块配置\n     * @returns 方块\n     */\n    public getBlock(blockConfig: BlockConfig, parent?: cc.Node): BaseBlock {\n        const blockStyle = this.getBlockStyle(blockConfig.type);\n        if (!blockStyle) {\n            return null;\n        }\n        const block = this.getBlockLoop().get(blockConfig, blockStyle, parent);\n        if (!block) {\n            const newBlock = cc.instantiate(this.blockPrefab);\n            const blockComp = newBlock.getComponent(BaseBlock);\n            blockComp.reuse(blockConfig, blockStyle, parent);\n            return blockComp;\n        }\n        return block.getComponent(BaseBlock);\n    }\n\n    /**\n     * 回收方块\n     * @param block 方块\n     */\n    public putBlock(block: BaseBlock): void {\n        this._blockLoop.put(block.node);\n    }\n\n    public getBlockLoop(): cc.NodePool {\n        if (!this._blockLoop) {\n            this._blockLoop = new cc.NodePool(BaseBlock);\n        }\n        return this._blockLoop;\n    }\n\n    /**\n     * 销毁\n     */\n    protected onDestroy(): void {\n        this._blockLoop && this._blockLoop.clear();\n        this._blockLoop = null;\n    }\n}\n"]}